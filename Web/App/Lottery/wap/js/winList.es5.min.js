"use strict";var winListVm=new Vue({el:"#wrapWinList",data:{handler:"/Serv/AwardApi.ashx",lottoryId:GetParm("lottoryId"),lottery:{winRecord:[]},dialog:{show:!1,title:"系统提示",msg:""},modalSubmitUserInfo:{show:!1,name:"",phone:""},currOpearteItem:{}},methods:{init:function(){var n=this;$.getJSON(this.handler+"?"+$.param({action:"GetLottery",id:this.lottoryId}),function(t){n.closeLoading();$("#wrapWinList").show();t.IsSuccess?n.lottery=t.Result:n.dialog={show:!0,title:"系统提示",msg:t.Msg}})},loading:function(){$("#loadingToast").show()},closeLoading:function(){$("#loadingToast").hide()},closeDialog:function(){this.dialog.show=!1},openSubmitUserInfo:function(n){this.currOpearteItem=n;this.modalSubmitUserInfo={show:!0,name:this.lottery.currUserName,phone:this.lottery.currUserPhone}},submitUserInfo:function(){this.modalSubmitUserInfo.name=_.trim(this.modalSubmitUserInfo.name);this.modalSubmitUserInfo.phone=_.trim(this.modalSubmitUserInfo.phone);this.modalSubmitUserInfo.name||alert("请输入领奖姓名");this.modalSubmitUserInfo.phone||alert("请输入领奖手机");this.loading();var n=this;$.post(this.handler,{action:"SubmitInfo",id:this.lottoryId,aid:this.currOpearteItem.id,rid:this.currOpearteItem.rid,name:this.modalSubmitUserInfo.name,phone:this.modalSubmitUserInfo.phone},function(t){n.closeLoading();t=JSON.parse(t);t.IsSuccess?(n.currOpearteItem.record_user_name=n.modalSubmitUserInfo.name,n.currOpearteItem.record_user_phone=n.modalSubmitUserInfo.phone,n.modalSubmitUserInfo.show=!1):alert(t.Msg)})},cancelSubmitUserInfo:function(){this.modalSubmitUserInfo.show=!1},getAward:function(n){var t=this;layer.open({content:"确认领奖？",btn:["确认","取消"],yes:function(i){t.loading();layer.close(i);$.post(t.handler,{action:"GetAward",id:t.lottoryId,aid:n.id,rid:n.rid},function(i){i=JSON.parse(i);t.closeLoading();i.IsSuccess?n.is_reveice=!0:alert(i.Msg)})}})}}});$(function(){winListVm.loading();winListVm.init();document.title="中奖记录"});